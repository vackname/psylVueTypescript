let catchContainerNameStr=" image: ";var runSys=false;var dockerVersion="3.3.0.0";function sleep(ms){return new Promise(resolve=>{setTimeout(resolve,ms)})}var colors={empty:"[0m",bright:"[1m",grey:"[2m",italic:"[3m",underline:"[4m",reverse:"[7m",hidden:"[8m",black:"[30m",red:"[31m",green:"[32m",yellow:"[33m",blue:"[34m",magenta:"[35m",cyan:"[36m",white:"[37m",blackBG:"[40m",redBG:"[41m",greenBG:"[42m",yellowBG:"[43m",blueBG:"[44m",magentaBG:"[45m",cyanBG:"[46m",whiteBG:"[47m"};var dockerForYml={command:"",debug:"",socket:"",web:"",nginx:"",web_port:"",netWorkName:"",projectTagName:""};function catchYml(){if(dockerForYml.command==""||dockerForYml.command==null||dockerForYml.command==undefined){var fs=require("fs");var containerName="";var containerNameDebug="";var containerNameWebSocket="";var containerNameWeb="";var containerNameWebNginx="";var containerPort="";var containerNetWorkName="";var projectTagName="";try{let fileContents=fs.readFileSync("./docker-compose.yml","utf8");containerName=fileContents.split("container_name: ")[1].split("\n")[0].replace(/\r/g,"").replace(/ /g,"");containerNameDebug=fileContents.split(catchContainerNameStr)[2].split("container_name: ")[1].split("\n")[0].replace(/\r/g,"").replace(/ /g,"");containerNameWebSocket=fileContents.split(catchContainerNameStr)[3].split("container_name: ")[1].split("\n")[0].replace(/\r/g,"").replace(/ /g,"");containerNameWeb=fileContents.split(catchContainerNameStr)[4].split("container_name: ")[1].split("\n")[0].replace(/\r/g,"").replace(/ /g,"");containerNameWebNginx=fileContents.split("image: nginx")[1].split("container_name: ")[1].split("\n")[0].replace(/\r/g,"").replace(/ /g,"");containerPort=fileContents.split("image: nginx")[1].split("ports:")[1].split(":80")[0].split("- ")[1];containerNetWorkName=fileContents.split("external")[1].split("name:")[1].replace(/ /g,"");const pathRoot=require("path");var pjTagNameObj=pathRoot.dirname(require.main.filename).split("/");projectTagName=pjTagNameObj[pjTagNameObj.length-1]}catch(e){console.log(colors.empty+colors.red+e)}dockerForYml.command=containerName;dockerForYml.debug=containerNameDebug;dockerForYml.socket=containerNameWebSocket;dockerForYml.web=containerNameWeb;dockerForYml.nginx=containerNameWebNginx;dockerForYml.web_port=containerPort;dockerForYml.netWorkName=containerNetWorkName;dockerForYml.projectTagName=projectTagName}return dockerForYml}async function psylProjectListAsync(){var fsJsProject=require("fs");var addPJ=[];await new Promise((resolve,reject)=>{fsJsProject.readdir("./src/",(err,files)=>{files.forEach((file,nu)=>{if(fsJsProject.statSync("./src/"+file).isDirectory()){if(fsJsProject.existsSync("./src/"+file+"/package.json")){addPJ.push(file)}}});resolve()})});return addPJ}function addDockerignore(){const fs=require("fs");if(!fs.existsSync("./.dockerignore")){const zlib=require("zlib");var dockerDockerignore="H4sIAAAAAAAAA1WPTW7DIBCF9zkKUsgZqtqLSmkX9QEsDBOCC4zFjC3l9jFDIzmr7/3oiUGpi7bREC2G7ye1O4f2D0rwGQtIAHkT+sAvHtql4Ay2NQTMIXsSw4iR2BQPrdzoHxadTJVWdaxXgtK8m5KLTc63VMUUcoW9m8Kyb9edLaYFCZSUB91JfQux2bw/NSZ0awRZ5yWdHUyr1xF9DXCaKwhsASbtYNMPk+SGzcQV3iOlu2EcuH79+vXZ/wz96bf/6L57ndwTYJKflEkBAAA=";var buf=Buffer.from(dockerDockerignore,"base64");zlib.unzip(buf,function(err,buffer){if(err)throw err;dockerDockerignore=buffer.toString("utf8");fs.writeFile("./.dockerignore",dockerDockerignore,function(err2){if(err2)throw err2})})}}function psylProjectPackageTypeScriptPathStringList(pjName){var typeArray=[];var fsDotnetProjet=require("fs");if(fsDotnetProjet.existsSync("./src/"+pjName+"/tscpackage.json")){let psylPackage=JSON.parse(fsDotnetProjet.readFileSync("./src/"+pjName+"/tscpackage.json","utf8"));if(psylPackage!=null&&psylPackage!=undefined){psylPackage.forEach((val,nu)=>{var reJoin=val.src.split("/");var addPath=[];reJoin.forEach((val2,nu2)=>{if(val2!="tsconfig.json"){addPath.push(val2)}});typeArray.push(addPath.join("/"))})}}return typeArray}function psylProjectPackageViewTypeList(pjName){var typeArray=[];var fsDotnetProjet=require("fs");if(fsDotnetProjet.existsSync("./src/"+pjName+"/package.json")){let psylPackage=JSON.parse(fsDotnetProjet.readFileSync("./src/"+pjName+"/package.json","utf8"))[0].inputFiles;if(psylPackage!=null&&psylPackage!=undefined){psylPackage.forEach((val,nu)=>{if(val.indexOf("/"+pjName+"/controllers/")==0&&val.indexOf(".ts")>-1){psylPackage.forEach((val2,nu2)=>{if(val.replace("/controllers/","/view/")==val2&&val.indexOf(".ts")>-1){typeArray.push(val2.substring(pjName.length+7,val2.length-3))}})}})}}return typeArray}async function pythonProjectExisTypeAsync(){var fsPythonProject=require("fs");var addPJ=[];await new Promise((resolve,reject)=>{fsPythonProject.readdir("./PythonProject/",(err,files)=>{files.forEach((file,nu)=>{if(fsPythonProject.statSync("./PythonProject/"+file).isDirectory()){if(fsPythonProject.existsSync("./PythonProject/"+file+"/requirements.txt")){if(!fsPythonProject.existsSync("./PythonProject/"+file+"/app.py")&&!fsPythonProject.existsSync("./PythonProject/"+file+"/Dockerfile.webapi")&&!fsPythonProject.existsSync("./PythonProject/"+file+"/Dockerfile.console")){addPJ.push({type:"classlib",name:file})}else if(fsPythonProject.existsSync("./PythonProject/"+file+"/Dockerfile.webapi")){addPJ.push({type:"webapi",name:file})}else if(fsPythonProject.existsSync("./PythonProject/"+file+"/Dockerfile.console")){addPJ.push({type:"console",name:file})}else{addPJ.push({type:"unknow",name:file})}}}});resolve()})});return addPJ}async function golangProjectExisTypeAsync(){var fsGolangProject=require("fs");var addPJ=[];await new Promise((resolve,reject)=>{fsGolangProject.readdir("./goProject/",(err,files)=>{files.forEach((file,nu)=>{if(fsGolangProject.statSync("./goProject/"+file).isDirectory()){if(fsGolangProject.existsSync("./goProject/"+file+"/Dockerfile.golang")){addPJ.push({type:"app",name:file})}else{addPJ.push({type:"unknow",name:file})}}});resolve()})});return addPJ}async function dotnetProjectExisTypeAsync(){var fsDotnetProject=require("fs");var addPJ=[];await new Promise((resolve,reject)=>{fsDotnetProject.readdir("./DotNetProject/",(err,files)=>{files.forEach((file,nu)=>{if(fsDotnetProject.statSync("./DotNetProject/"+file).isDirectory()){if(fsDotnetProject.existsSync("./DotNetProject/"+file+"/"+file+".csproj")){if(!fsDotnetProject.existsSync("./DotNetProject/"+file+"/Controllers")&&!fsDotnetProject.existsSync("./DotNetProject/"+file+"/Program.cs")&&!fsDotnetProject.existsSync("./DotNetProject/"+file+"/Dockerfile.webapi")&&!fsDotnetProject.existsSync("./DotNetProject/"+file+"/Dockerfile.console")){addPJ.push({type:"classlib",name:file})}else if(fsDotnetProject.existsSync("./DotNetProject/"+file+"/Dockerfile.webapi")){addPJ.push({type:"webapi",name:file})}else if(fsDotnetProject.existsSync("./DotNetProject/"+file+"/Dockerfile.console")){addPJ.push({type:"console",name:file})}else{addPJ.push({type:"unknow",name:file})}}}});resolve()})});return addPJ}function vscodeLaunchProjectList(){var projectArray=[];var fsDotnetProjet=require("fs");if(fsDotnetProjet.existsSync("./.vscode/launch.json")&&fsDotnetProjet.existsSync("./.vscode/tasks.json")){let dotnetDebugLaunch=JSON.parse(fsDotnetProjet.readFileSync("./.vscode/launch.json","utf8")).configurations;if(dotnetDebugLaunch!=null&&dotnetDebugLaunch!=undefined){dotnetDebugLaunch.forEach((val,nu)=>{if(val.type=="docker"||val.type=="go"&&val.name.indexOf("Docker golang:created_debug_app:")==0){if(val.preLaunchTask.indexOf("docker-run: debug_for_")==0){var charLenth=0;var typeName="";if(val.preLaunchTask.indexOf("docker-run: debug_for_python_flask_")==0){charLenth=35;typeName="python"}else if(val.preLaunchTask.indexOf("docker-run: debug_for_python_general_")==0){charLenth=37;typeName="python"}else if(val.preLaunchTask.indexOf("docker-run: debug_for_golang_app_")==0){charLenth=33;typeName="golang"}else{console.log(al.preLaunchTask);charLenth=22;typeName="dotnet"}projectArray.push({type:typeName,name:val.preLaunchTask.substring(charLenth),task:val.preLaunchTask,dotnetPath:typeName=="dotnet"?val.netCore.appProject.replace("${workspaceFolder}",""):""})}}})}}return projectArray}function vscodeTasksInfo(searchPJName,typeName){var fs=require("fs");if(fs.existsSync("./.vscode/launch.json")&&fs.existsSync("./.vscode/tasks.json")){var addFileFlod="";switch(typeName){case"python":addFileFlod="PythonProject";break;case"golang":addFileFlod="goProject";break;case"dotnet":addFileFlod="DotNetProject";break}if(fs.existsSync("./"+addFileFlod+"/"+searchPJName)){let DebugLaunch=vscodeLaunchProjectList();var LaunchExist=false;DebugLaunch.forEach((val,nu)=>{if(val.name==searchPJName&&typeName==val.type){LaunchExist=true}});if(LaunchExist){let DebugTasks=JSON.parse(fs.readFileSync("./.vscode/tasks.json","utf8")).tasks;if(DebugTasks!=null&&DebugTasks!=undefined){var toDebugInfo=[];DebugTasks.forEach((val,nu)=>{if(val.type=="docker-run"){var checkTaskExist=false;switch(typeName){case"python":checkTaskExist=["docker-run: debug_for_python_general_"+searchPJName,"docker-run: debug_for_python_flask_"+searchPJName].indexOf(val.label)>-1;break;case"golang":checkTaskExist=["docker-run: debug_for_golang_app_"+searchPJName].indexOf(val.label)>-1;break;case"dotnet":checkTaskExist=val.label=="docker-run: debug_for_"+searchPJName;break}if(checkTaskExist){if(val.dockerRun.env!=null&&val.dockerRun.env!=undefined){if(val.dockerRun.env.hostname!=null&&val.dockerRun.env.hostname!=undefined){toDebugInfo.push(["env hostname         ",val.dockerRun.env.hostname])}toDebugInfo.push(["env network          ",val.dockerRun.env.network]);if(val.dockerRun.env.ASPNETCORE_URLS!=null&&val.dockerRun.env.ASPNETCORE_URLS!=undefined){toDebugInfo.push(["env ASPNETCORE_URLS  ",val.dockerRun.env.ASPNETCORE_URLS])}}if(val.dockerRun.ports!=null&&val.dockerRun.ports!=undefined){val.dockerRun.ports.forEach((val2,nu2)=>{toDebugInfo.push(["port["+(nu2+1)+"]              ",val2.hostPort+":"+val2.containerPort])})}}}});if(toDebugInfo.length!=0){console.log(colors.empty+colors.blueBG+colors.white+"Docker"+colors.empty+colors.yellow+" Debug setting for info->");toDebugInfo.forEach((val,nu)=>{console.log(colors.empty+colors.grey+val[0]+colors.empty+colors.green+val[1])})}else{console.log(colors.grey+colors.yellow+"not exist "+typeName+" for project info....")}}}else{console.log(colors.grey+colors.red+"not exist "+typeName+" for project["+searchPJName+"]....");console.log(colors.grey+colors.red+"./.vscode/launch.json type = 'docker',preLaunchTask = 'docker-run: debug_for_"+(typeName=="dotnet"?"":typeName)+"..."+searchPJName+"'")}}else{console.log(colors.grey+colors.red+"not exist "+typeName+" for project....")}}else{console.log(colors.grey+colors.red+"not exist "+typeName+" for project....")}console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white)}let rlSyncOrderLineRun=null;let saveCmmand="";async function toCommand(arg){setTimeout(function(){saveCmmand=""},3e3);if(arg.length>2?true:arg.indexOf("launch")==1){var anws="";var toOder=[];if(arg[1]=="npm"||arg[1]=="npx"||arg[1]=="node"||arg[1]=="dotnet"||arg[1]=="python"||arg[1]=="golang"||arg[1]=="launch"){anws=arg[1];arg.forEach(function(an,nu){if(nu>0){toOder.push(an)}});switch(anws){case"launch":if(arg.length==2){addDockerignore();rlSyncOrderLineRun.close();rlSyncOrderLineRun=null;await new Promise((resolve,reject)=>{let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});console.log(colors.empty+colors.grey+"(0) cancel");console.log(colors.empty+colors.cyan+"(1) create launch muliteple");console.log(colors.empty+colors.cyan+"(2) launch add project");console.log(colors.empty+colors.cyan+"(3) project info(VSCode debug)");rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"launch for VSCode debug?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: enter 1"+colors.empty+"\n"+colors.empty+colors.grey+" choose for number "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();var toLaunchNumber=-1;try{toLaunchNumber=Number(answer)}catch(e){}if(toLaunchNumber>0&&toLaunchNumber<=3){arg=["","vscode"];arg.push(["debugs","addinit","-info"][toLaunchNumber-1]);anws=arg[1];toOder=[];arg.forEach(function(an,nu){if(nu>0){toOder.push(an)}});resolve(toLaunchNumber)}else if(toLaunchNumber==0){reject("stop launch for use")}else{reject("error set launch number")}})}).then(async()=>{if(arg[2]=="debugs"){var projectArray=vscodeLaunchProjectList();return new Promise((resolve,reject)=>{if(projectArray.length>0){let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"create launch name?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: Docker All Debug"+colors.empty+"\n"+colors.empty+colors.grey+" name "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();if(answer!=""){toOder.push("--name");toOder.push(answer.replace(/ /g,"&nbsp;"));resolve()}else{reject("fail empty value(launch name)")}})}else{reject("not exist project")}}).then(async function(){var addProjects=[];function addProject(addNewProjectNameVal){var toExistProject=false;projectArray.forEach((val,nu)=>{if(addProjects.indexOf(nu+1)==-1){toExistProject=true;console.log(colors.empty+colors.cyan+"("+(nu+1)+") "+colors.empty+colors.grey+val.type+"-> "+colors.empty+colors.blue+val.name)}});if(addNewProjectNameVal!="first"){console.log(colors.empty+colors.green+"(yes)"+colors.empty+colors.grey+" check settig for project");console.log(colors.empty+colors.cyan+"(cancel)"+colors.empty+colors.grey+" leave");if(addNewProjectNameVal=="[notExist]"){console.log(colors.empty+colors.red+"Not exist project")}else if(addNewProjectNameVal!=""){console.log(colors.empty+colors.green+"add "+projectArray[addNewProjectNameVal-1].type+"-> "+projectArray[addNewProjectNameVal-1].name)}else{console.log(colors.empty+colors.blue+"exist project")}var nowChooseProject=[];addProjects.forEach((val,nu)=>{nowChooseProject.push(projectArray[val-1].type+"-> "+projectArray[val-1].name)});console.log(colors.empty+colors.yellowBG+colors.green+"launch->"+colors.empty+colors.grey+"["+nowChooseProject.join(",")+"]")}else{console.log(colors.empty+colors.cyan+"(cancel)"+colors.empty+colors.grey+" leave")}return new Promise((resolve,reject)=>{let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});var projectChooseQ="search project"+(addProjects.length>0?" or (yes)":"")+"?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: enter 1"+colors.empty+"\n"+colors.empty+colors.grey+" choose for number ";rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+(toExistProject?projectChooseQ:"How choose(yes/cancel)")+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",async function(answer){rlSync.close();var getAnswer=answer.toLowerCase();if(getAnswer!="yes"&&getAnswer!="cancel"&&toExistProject){var toProjectNumber=-1;try{toProjectNumber=Number(answer)}catch(e){console.log(e)}if(toProjectNumber>0&&projectArray.length>=toProjectNumber){var addNewProjectName=toProjectNumber>0?toProjectNumber:"[notExist]";if(addNewProjectName==null||addNewProjectName==undefined){addNewProjectName="[notExist]"}else{if(addProjects.indexOf(addNewProjectName)==-1){addProjects.push(addNewProjectName)}else{addNewProjectName=""}}await addProject(addNewProjectName);resolve("")}else{console.log(colors.empty+colors.red+colors.yellowBG+"error set project number"+colors.empty);resolve("")}}resolve(answer)})}).then(function(answer){if(answer!=""){if(answer=="cancel"){addProjects=[]}else if(addProjects.length<=1){addProjects=[];console.log(colors.empty+colors.red+"not choose project"+colors.empty)}}})}return addProject("first").then(function(){if(addProjects.length>1){toOder.push("--configs");toOder.push(addProjects.join(","))}})})}else if(arg[2]=="-info"){anws="vscodeTasksInfo";return new Promise((resolve,reject)=>{var projectArray=vscodeLaunchProjectList();if(projectArray.length>0){projectArray.forEach((val,nu)=>{console.log(colors.empty+colors.cyan+"("+(nu+1)+") "+colors.empty+colors.grey+val.type+"-> "+colors.empty+colors.blue+val.name)});let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"search project?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: enter 1"+colors.empty+"\n"+colors.empty+colors.grey+" choose for number "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();var toProjectNumber=-1;try{toProjectNumber=Number(answer)}catch(e){}if(toProjectNumber>0&&projectArray.length>=toProjectNumber){arg.push(toProjectNumber);resolve(toProjectNumber)}else{reject("error set project number")}})}else{reject("not exist project fort dotnet"+colors.empty)}})}else if(arg[2]=="addinit"){return new Promise(async(resolve,reject)=>{var LaunchPJ=vscodeLaunchProjectList();var notAddLaunch=[];var golangProjectList=await golangProjectExisTypeAsync();golangProjectList.forEach((val,nu)=>{var checkAdd=true;LaunchPJ.forEach((valL,nuL)=>{if(valL.type=="golang"){if(valL.name==val.name){checkAdd=false}}});if(checkAdd){notAddLaunch.push([val,"golang"])}});var dotnetProjectList=await dotnetProjectExisTypeAsync();dotnetProjectList.forEach((val,nu)=>{if(val.type!="classlib"){var checkAdd=true;LaunchPJ.forEach((valL,nuL)=>{if(valL.type=="dotnet"){if(valL.name==val.name){checkAdd=false}}});if(checkAdd){notAddLaunch.push([val,"dotnet"])}}});var pythonProjectList=await pythonProjectExisTypeAsync();pythonProjectList.forEach((val,nu)=>{if(val.type!="classlib"){var checkAdd=true;LaunchPJ.forEach((valL,nuL)=>{if(valL.type=="python"){if(valL.name==val.name){checkAdd=false}}});if(checkAdd){notAddLaunch.push([val,"python"])}}});if(notAddLaunch.length>0){resolve(notAddLaunch)}else{reject("not exist project!")}}).then(function(notAddLaunch){return new Promise((resolve,reject)=>{notAddLaunch.forEach((val,nu)=>{console.log(colors.empty+colors.cyan+"("+(nu+1)+") "+colors.empty+colors.grey+val[1]+"-> "+colors.empty+colors.blue+val[0].name)});let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"search project?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: enter 1"+colors.empty+"\n"+colors.empty+colors.grey+" choose for number "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();var toProjectNumber=-1;try{toProjectNumber=Number(answer)}catch(e){}if(toProjectNumber>0&&notAddLaunch.length>=toProjectNumber){resolve(notAddLaunch[toProjectNumber-1])}else{reject("error set project number")}})})}).then(function(chooseNotAddLanch){return new Promise(function(resolve,reject){if(chooseNotAddLanch[0].type=="unknow"){let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});console.log(colors.empty+colors.cyan+"(1) webapi");console.log(colors.empty+colors.cyan+"(2) console");rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"create project type?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: enter 1"+colors.empty+"\n"+colors.empty+colors.grey+" choose for number "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();var toProjectNumber=-1;try{toProjectNumber=Number(answer)}catch(e){}if(toProjectNumber>0&&toProjectNumber<=2){chooseNotAddLanch[0].type=["webapi","console"][toProjectNumber-1];resolve(chooseNotAddLanch)}else{reject("error set project number")}})}else{resolve(chooseNotAddLanch)}})}).then(function(chooseNotAddLanch){arg=["",chooseNotAddLanch[1],"addinit",chooseNotAddLanch[0].type];toOder=[chooseNotAddLanch[1],"addinit",chooseNotAddLanch[0].type];return new Promise(function(resolve,reject){arg.push("-o");arg.push(chooseNotAddLanch[0].name);toOder.push("-o");toOder.push(chooseNotAddLanch[0].name);if(chooseNotAddLanch[0].type=="webapi"){let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"web for port(docker container for local)?"+colors.empty+"\n"+colors.empty+colors.grey+"(default:5000)"+colors.empty+"\n"+colors.empty+colors.grey+" Anwser "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();answer=answer.replace(/ /g,"_");var toContainerPort=5e3;try{toContainerPort=Number(answer);if(answer!=""?toContainerPort==0||answer*0!=0:true){toContainerPort=5e3;console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white);console.log(colors.empty+colors.yellow+"default port for 5000")}}catch(e){toContainerPort=5e3;console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white);console.log(colors.empty+colors.red+"error set port for 5000"+colors.empty)}if(toContainerPort!=5e3&&toContainerPort>-1){arg.push("-p");arg.push(toContainerPort);toOder.push("-p");toOder.push(toContainerPort)}resolve(chooseNotAddLanch)})}else{resolve(chooseNotAddLanch)}})}).then(function(chooseNotAddLanch){arg.push("-network");arg.push(catchYml().netWorkName);toOder.push("-network");toOder.push(catchYml().netWorkName);arg.push("-dockerName");arg.push(catchYml().projectTagName);toOder.push("-dockerName");toOder.push(catchYml().projectTagName);const fs=require("fs");fs.mkdir("./.vscode",err=>{try{if(err.code!="EEXIST"){return console.error(err)}}catch(e){return console.log(colors.empty+colors.green+"failed Directory created(.vscode)!")}});var mkdirPath="";switch(chooseNotAddLanch[1]){case"python":mkdirPath="./PythonProject";break;case"golang":mkdirPath="./goProject";break;case"dotnet":mkdirPath="./DotNetProject";break}fs.mkdir(mkdirPath,err=>{try{if(err.code!="EEXIST"){return console.error(err)}}catch(e){return console.log(colors.empty+colors.green+"failed Directory created!(.DotNetProject)")}});setTimeout(function(){vscodeTasksInfo(chooseNotAddLanch[0].name,chooseNotAddLanch[1]);if(chooseNotAddLanch[1]=="dotnet"){const fs=require("fs");if(fs.existsSync("./"+catchYml().projectTagName+".sln")){const fs2=require("fs");fs2.unlink("./"+catchYml().projectTagName+".sln",err=>{})}var cp=require("child_process");cp.exec(`dotnet new sln --name ${catchYml().projectTagName}`,function(error,stdout,stderr){cp.exec(`dotnet sln add ./DotNetProject/*/*.csproj`,function(error1,stdout1,stderr1){})})}},2e3)})}}).catch(error=>{if(error!=null&&error!=undefined&&error!=""){console.log(colors.empty+colors.red+colors.yellowBG+error+colors.empty)}})}break;case"python":if(arg[2]=="new"&&arg.length==3){addDockerignore();rlSyncOrderLineRun.close();rlSyncOrderLineRun=null;await new Promise((resolve,reject)=>{let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});console.log(colors.empty+colors.grey+"(0) cancel");var pythonVersionAry=["3.13.0b2","3.12.4","3.11.9","3.10.14","3.9.19"];pythonVersionAry.forEach((val,nu)=>{console.log(colors.empty+colors.cyan+"("+(nu+1)+") "+val)});rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"create python version?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: enter 1"+colors.empty+"\n"+colors.empty+colors.grey+" choose for number "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();var toVerNumber=-1;try{toVerNumber=Number(answer)}catch(e){}if(toVerNumber>0&&toVerNumber<=pythonVersionAry.length){resolve(pythonVersionAry[toVerNumber-1])}else if(toVerNumber==0){reject("stop python for new")}else{reject("error set Version number")}})}).then(function(PythonVersion){return new Promise((resolve,reject)=>{let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});console.log(colors.empty+colors.grey+"(0) cancel");console.log(colors.empty+colors.cyan+"(1) webapi");console.log(colors.empty+colors.cyan+"(2) console");rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"create project?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: enter 1"+colors.empty+"\n"+colors.empty+colors.grey+" choose for number "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();var toProjectNumber=-1;try{toProjectNumber=Number(answer)}catch(e){}if(toProjectNumber>0&&toProjectNumber<=2){toOder.push(["webapi","console"][toProjectNumber-1]);toOder.push("-version");toOder.push(PythonVersion);resolve(toProjectNumber)}else if(toProjectNumber==0){reject("stop python for new")}else{reject("error set project number")}})})}).then(function(toProjectNumber){return new Promise(function(resolve,reject){let rlSync2=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync2.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"create project name?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: webAPI1"+colors.empty+"\n"+colors.empty+colors.grey+" name "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer2){rlSync2.close();answer2=answer2.replace(/ /g,"_");if(answer2!=""){toOder.push("-o");toOder.push(answer2);if(toProjectNumber==1){let rlSync3=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync3.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"web for port(docker container for local)?"+colors.empty+"\n"+colors.empty+colors.grey+"(default:5000)"+colors.empty+"\n"+colors.empty+colors.grey+" Anwser "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer3){rlSync3.close();answer3=answer3.replace(/ /g,"_");var toContainerPort=5e3;try{toContainerPort=Number(answer3);if(answer3!=""?toContainerPort==0||answer3*0!=0:true){toContainerPort=5e3;console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white);console.log(colors.empty+colors.yellow+"default port for 5000")}}catch(e){toContainerPort=5e3;console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white);console.log(colors.empty+colors.red+"error set port for 5000"+colors.empty)}if(toContainerPort!=5e3&&toContainerPort>-1){toOder.push("-p");toOder.push(toContainerPort)}resolve(answer2)})}else{resolve(answer2)}}else{reject()}})})}).then(function(projectName){toOder.push("-network");toOder.push(catchYml().netWorkName);toOder.push("-dockerName");toOder.push(catchYml().projectTagName);setTimeout(function(){var fsPythonProjet=require("fs");if(fsPythonProjet.existsSync("./.vscode/launch.json")&&fsPythonProjet.existsSync("./.vscode/tasks.json")){if(fsPythonProjet.existsSync("./PythonProject/"+projectName)){let dotnetDebugLaunch=JSON.parse(fsPythonProjet.readFileSync("./.vscode/launch.json","utf8")).configurations;var LaunchExist=false;if(dotnetDebugLaunch!=null&&dotnetDebugLaunch!=undefined){dotnetDebugLaunch.forEach((val,nu)=>{if(val.type=="docker"){if(["docker-run: debug_for_python_flask_"+projectName,"docker-run: debug_for_python_general_"+projectName].indexOf(val.preLaunchTask)>-1){LaunchExist=true}}})}if(LaunchExist){vscodeTasksInfo(projectName,"python")}}}},2e3)}).catch(error=>{if(error!=null&&error!=undefined&&error!=""){console.log(colors.empty+colors.red+colors.yellowBG+error+colors.empty)}});const fs=require("fs");fs.mkdir("./.vscode",err=>{try{if(err.code!="EEXIST"){return console.error(err)}}catch(e){return console.log(colors.empty+colors.green+"failed Directory created(.vscode)!")}});fs.mkdir("./PythonProject",err=>{try{if(err.code!="EEXIST"){return console.error(err)}}catch(e){return console.log(colors.empty+colors.green+"failed Directory created!(.PythonProject)")}})}break;case"golang":if(arg[2]=="new"&&arg.length==3){addDockerignore();rlSyncOrderLineRun.close();rlSyncOrderLineRun=null;await new Promise((resolve,reject)=>{let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});console.log(colors.empty+colors.grey+"(0) cancel");console.log(colors.empty+colors.cyan+"(1) app");rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"create project?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: enter 1"+colors.empty+"\n"+colors.empty+colors.grey+" choose for number "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();var toProjectNumber=-1;try{toProjectNumber=Number(answer)}catch(e){}if(toProjectNumber>0&&toProjectNumber<=2){toOder.push(["app"][toProjectNumber-1]);resolve(toProjectNumber)}else if(toProjectNumber==0){reject("stop python for new")}else{reject("error set project number")}})}).then(function(toProjectNumber){return new Promise(function(resolve,reject){let rlSync2=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync2.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"create project name?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: webAPI1"+colors.empty+"\n"+colors.empty+colors.grey+" name "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer2){rlSync2.close();answer2=answer2.replace(/ /g,"_");if(answer2!=""){toOder.push("-o");toOder.push(answer2);if(toProjectNumber==1){let rlSync3=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync3.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"web for port(docker container for local)?"+colors.empty+"\n"+colors.empty+colors.grey+"(default:5001)"+colors.empty+"\n"+colors.empty+colors.grey+" Anwser "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer3){rlSync3.close();answer3=answer3.replace(/ /g,"_");var toContainerPort=5e3;try{toContainerPort=Number(answer3);if(answer3!=""?toContainerPort==0||answer3*0!=0:true){toContainerPort=5e3;console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white);console.log(colors.empty+colors.yellow+"default port for 5001")}}catch(e){toContainerPort=5e3;console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white);console.log(colors.empty+colors.red+"error set port for 5001"+colors.empty)}if(toContainerPort!=5e3&&toContainerPort>-1){toOder.push("-p");toOder.push(toContainerPort)}resolve(answer2)})}else{resolve(answer2)}}else{reject()}})})}).then(function(projectName){toOder.push("-network");toOder.push(catchYml().netWorkName);toOder.push("-dockerName");toOder.push(catchYml().projectTagName);setTimeout(function(){var fsGolangProjet=require("fs");if(fsGolangProjet.existsSync("./.vscode/launch.json")&&fsGolangProjet.existsSync("./.vscode/tasks.json")){if(fsGolangProjet.existsSync("./goProject/"+projectName)){let dotnetDebugLaunch=JSON.parse(fsGolangProjet.readFileSync("./.vscode/launch.json","utf8")).configurations;var LaunchExist=false;if(dotnetDebugLaunch!=null&&dotnetDebugLaunch!=undefined){dotnetDebugLaunch.forEach((val,nu)=>{if(val.type=="go"){if(["docker-run: debug_for_golang_app_"+projectName].indexOf(val.preLaunchTask)>-1){LaunchExist=true}}})}if(LaunchExist){vscodeTasksInfo(projectName,"golang")}}}},2e3)}).catch(error=>{if(error!=null&&error!=undefined&&error!=""){console.log(colors.empty+colors.red+colors.yellowBG+error+colors.empty)}});const fs=require("fs");fs.mkdir("./.vscode",err=>{try{if(err.code!="EEXIST"){return console.error(err)}}catch(e){return console.log(colors.empty+colors.green+"failed Directory created(.vscode)!")}});fs.mkdir("./goProject",err=>{try{if(err.code!="EEXIST"){return console.error(err)}}catch(e){return console.log(colors.empty+colors.green+"failed Directory created!(.goProject)")}})}break;case"dotnet":if(arg[2]=="reference"){anws="dotnetreference";if(arg.length==3){toOder=[];var launchData=vscodeLaunchProjectList();var projectArray=[];launchData.forEach((val,nu)=>{if(val.type=="dotnet"){const fs=require("fs");if(fs.existsSync("./DotNetProject/"+val.name+"/"+val.name+".csproj")){let fileContentsDotnetProject=fs.readFileSync("./DotNetProject/"+val.name+"/"+val.name+".csproj","utf8");var splitRefrence=fileContentsDotnetProject.split("<ProjectReference ");var catchRefrence=[];splitRefrence.forEach((val,nu)=>{if(nu>0){catchRefrence.push(val.split("/>")[0].split('"')[1])}});projectArray.push({name:val.name,isProject:true,path:val.dotnetPath,existRefrence:catchRefrence})}}});var menu_dotnetProjectArray=await dotnetProjectExisTypeAsync();menu_dotnetProjectArray.forEach((val,nu)=>{if(val.type=="classlib"){const fs=require("fs");if(fs.existsSync("./DotNetProject/"+val.name+"/"+val.name+".csproj")){let fileContentsDotnetProject=fs.readFileSync("./DotNetProject/"+val.name+"/"+val.name+".csproj","utf8");var splitRefrence=fileContentsDotnetProject.split("<ProjectReference ");var catchRefrence=[];splitRefrence.forEach((val,nu)=>{if(nu>0){catchRefrence.push(val.split("/>")[0].split('"')[1])}});projectArray.push({name:val.name,isProject:false,path:"/DotNetProject/"+val.name+"/"+val.name+".csproj",existRefrence:catchRefrence})}}});if(projectArray.length>0){rlSyncOrderLineRun.close();rlSyncOrderLineRun=null;await new Promise((resolve,reject)=>{console.log(colors.empty+colors.cyan+"(0) remove");console.log(colors.empty+colors.cyan+"(1) add");console.log(colors.empty+colors.grey+"(2) cancel");let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"search type?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: enter 1"+colors.empty+"\n"+colors.empty+colors.grey+" choose for number "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();var toProjectTypeNu=-1;try{toProjectTypeNu=Number(answer)}catch(e){}if([0,1].indexOf(toProjectTypeNu)>-1){toOder.push(["remove","add"][toProjectTypeNu]);resolve()}else if(toProjectTypeNu==2){reject("stop dotnet for reference")}else{reject("error set type number")}})}).then(()=>{return new Promise((resolve,reject)=>{projectArray.forEach((val,nu)=>{console.log(colors.empty+colors.cyan+"("+(nu+1)+") "+colors.empty+colors.grey+(val.isProject?"launch ":"libary ")+colors.empty+colors.cyan+val.name+colors.empty+colors.grey+" ProjRef("+val.existRefrence.length+")")});console.log(colors.empty+colors.grey+"("+(projectArray.length+1)+") cancel");let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"search project?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: enter 1"+colors.empty+"\n"+colors.empty+colors.grey+" choose for number "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();var toProjectNumber=-1;try{toProjectNumber=Number(answer)}catch(e){}if(toProjectNumber>0&&projectArray.length>=toProjectNumber){var projectChoose=projectArray[toProjectNumber-1];resolve({name:projectChoose.name,path:"."+projectChoose.path,existRefrence:projectChoose.existRefrence})}else if(projectArray.length<toProjectNumber){reject("stop dotnet for reference")}else{reject("error set project number")}})})}).then(csprojpath=>{return new Promise(async(resolve,reject)=>{var dotnetProjectArray=await dotnetProjectExisTypeAsync();var classlibNu=0;var dotnetClassLibArray=[];dotnetProjectArray.forEach((val,nu)=>{if(val.type=="classlib"){var toPath=val.name+"/"+val.name+".csproj";if(toOder.indexOf("remove")>-1?csprojpath.existRefrence.indexOf("..\\"+toPath.replace(/\//g,"\\"))>-1:csprojpath.existRefrence.indexOf("..\\"+toPath.replace(/\//g,"\\"))==-1&&val.name!=csprojpath.name){console.log(colors.empty+colors.cyan+"("+(classlibNu+1)+") "+val.name);dotnetClassLibArray.push("./DotNetProject/"+toPath);classlibNu++}}});if(dotnetClassLibArray.length==0){reject("not existh for choose reference of project")}else{let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"search LibaryClass Project?"+colors.empty+colors.yellowBG+(toOder.indexOf("remove")>-1?"(remove)":"(add)")+colors.empty+"\n"+colors.empty+colors.grey+"ex: enter 1"+colors.empty+"\n"+colors.empty+colors.grey+" choose for number "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();var toProjectNumber=-1;try{toProjectNumber=Number(answer)}catch(e){}if(toProjectNumber>0&&dotnetClassLibArray.length>=toProjectNumber){toOder.push(csprojpath.path);toOder.push("reference");toOder.push(dotnetClassLibArray[toProjectNumber-1]);resolve()}else{reject("error set LibaryClass project number")}})}})}).catch(error=>{toOder=[];if(error!=null&&error!=undefined&&error!=""){console.log(colors.empty+colors.red+colors.yellowBG+error+colors.empty)}})}else{console.log(colors.empty+colors.red+"not exist project"+colors.empty)}}}else if(arg[2]=="new"&&arg.length==3){addDockerignore();rlSyncOrderLineRun.close();rlSyncOrderLineRun=null;await new Promise((resolve,reject)=>{let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});console.log(colors.empty+colors.grey+"(0) cancel");console.log(colors.empty+colors.cyan+"(1) webapi");console.log(colors.empty+colors.cyan+"(2) console");console.log(colors.empty+colors.cyan+"(3) classlib");rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"create project?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: enter 1"+colors.empty+"\n"+colors.empty+colors.grey+" choose for number "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();var toProjectNumber=-1;try{toProjectNumber=Number(answer)}catch(e){}if(toProjectNumber>0&&toProjectNumber<=3){toOder.push(["webapi","console","classlib"][toProjectNumber-1]);resolve(toProjectNumber)}else if(toProjectNumber==0){reject("stop dotnet for new")}else{reject("error set project number")}})}).then(function(toProjectNumber){return new Promise(function(resolve,reject){let rlSync2=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync2.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"create project name?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: webAPI1"+colors.empty+"\n"+colors.empty+colors.grey+" name "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer2){rlSync2.close();answer2=answer2.replace(/ /g,"_");if(answer2!=""){toOder.push("-o");toOder.push(answer2);if(toProjectNumber==1){let rlSync3=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync3.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"web for port(docker container for local)?"+colors.empty+"\n"+colors.empty+colors.grey+"(default:5000)"+colors.empty+"\n"+colors.empty+colors.grey+" Anwser "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer3){rlSync3.close();answer3=answer3.replace(/ /g,"_");var toContainerPort=5e3;try{toContainerPort=Number(answer3);if(answer3!=""?toContainerPort==0||answer3*0!=0:true){toContainerPort=5e3;console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white);console.log(colors.empty+colors.yellow+"default port for 5000")}}catch(e){toContainerPort=5e3;console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white);console.log(colors.empty+colors.red+"error set port for 5000"+colors.empty)}if(toContainerPort!=5e3&&toContainerPort>-1){toOder.push("-p");toOder.push(toContainerPort)}resolve(answer2)})}else{resolve(answer2)}}else{reject()}})})}).then(function(projectName){toOder.push("-network");toOder.push(catchYml().netWorkName);toOder.push("-dockerName");toOder.push(catchYml().projectTagName);const fs=require("fs");setTimeout(function(){var fsDotnetProjet=require("fs");if(fsDotnetProjet.existsSync("./.vscode/launch.json")&&fsDotnetProjet.existsSync("./.vscode/tasks.json")){if(fsDotnetProjet.existsSync("./DotNetProject/"+projectName)){let dotnetDebugLaunch=JSON.parse(fsDotnetProjet.readFileSync("./.vscode/launch.json","utf8")).configurations;var LaunchExist=false;if(dotnetDebugLaunch!=null&&dotnetDebugLaunch!=undefined){dotnetDebugLaunch.forEach((val,nu)=>{if(val.type=="docker"){if(val.preLaunchTask=="docker-run: debug_for_"+projectName){LaunchExist=true}}})}if(LaunchExist){vscodeTasksInfo(projectName,"dotnet")}}}if(fs.existsSync("./"+catchYml().projectTagName+".sln")){const fs2=require("fs");fs2.unlink("./"+catchYml().projectTagName+".sln",err=>{})}var cp=require("child_process");cp.exec(`dotnet new sln --name ${catchYml().projectTagName}`,function(error,stdout,stderr){cp.exec(`dotnet sln add ./DotNetProject/*/*.csproj`,function(error1,stdout1,stderr1){})})},2e3)}).catch(error=>{if(error!=null&&error!=undefined&&error!=""){console.log(colors.empty+colors.red+colors.yellowBG+error+colors.empty)}});const fs=require("fs");fs.mkdir("./.vscode",err=>{try{if(err.code!="EEXIST"){return console.error(err)}}catch(e){return console.log(colors.empty+colors.green+"failed Directory created(.vscode)!")}});fs.mkdir("./DotNetProject",err=>{try{if(err.code!="EEXIST"){return console.error(err)}}catch(e){return console.log(colors.empty+colors.green+"failed Directory created!(.DotNetProject)")}})}break}}else{if(arg[2]=="config"){rlSyncOrderLineRun.close();rlSyncOrderLineRun=null;await new Promise((resolve,reject)=>{let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});console.log(colors.empty+colors.cyan+"(1) init(re-set project/system info)");console.log(colors.empty+colors.cyan+"(2) add netcore project(webapi) Database/enum info souce code  of schema");console.log(colors.empty+colors.cyan+"(3) re-install psyl command for env(docker)");rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"re-set/build config?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: enter 1"+colors.empty+"\n"+colors.empty+colors.grey+" choose for number "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();var toProjectNumber=-1;try{toProjectNumber=Number(answer)}catch(e){}if(toProjectNumber>0&&toProjectNumber<=3){arg=[arg[0],arg[1],["-map","tscdb","docker"][toProjectNumber-1]];resolve(toProjectNumber)}else{reject("error set config number")}})}).then(argVal=>{switch(argVal){case 1:return new Promise(async(resolve,reject)=>{await toCommand(["node","psyl","join","project"]);resolve()});case 2:return new Promise((resolve,reject)=>{let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"Password?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: SamplePassword"+colors.empty+"\n"+colors.empty+colors.grey+" input string "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();if(answer!=""){arg.push(answer);resolve()}else{reject("not input value...")}})})}}).catch(error=>{if(error!=null&&error!=undefined&&error!=""){console.log(colors.empty+colors.red+colors.yellowBG+error+colors.empty)}})}anws=arg[2];arg.forEach(function(an,nu){if(nu>1){toOder.push(an)}})}if(anws=="-h"){var helpMes=[" psyl config          : init or add project/update or dotnet enum/database for info","@                          (1)init for project","@                             a.bundle to map datasource(debug/release)","@                             b.project view for page map","@                               path:src/models/SysConfig_Interface/ProjectMap","@                               ex typescript:","@                                   Component($t).import(temp=>temp.init.temp_index_head).exportVue($t.head)","@                          (2)add netcore project(webapi) Database/enum info souce code  of schema","@                             a.source->path /src/config/InterfaceJsonHost.json","@                               ex [{'host':'domain.com','port':'9888','Scheme':'https'}]","@                             b. password for netcore project(webapi) soucre code",'@                               ex VueBundleMiddleWare.tscOutPutPw = "samplePassword" //Defalut',"@                          (3)re-install psyl command for env(docker)","@"," psyl new             : create for vue of dev","@                          (1)create project","@                          (2)create project for view","@                          (3)create project for document","@                          (4)create project for typeScript Model","@"," psyl remove          : for project","@                          (1)remove project","@                          (2)remove view","@                          (3)remove typescript model","@                          (4)remove normal document html/css/sacss/ts","@"," psyl run             :","@                          (1)debug model","@                          (2)stop debug model or (key down close=[control+key.c])","@                          (3)run web server(preview)","@                          (4)stop web server(preview)","@                          (5)composer build for project (release)","@"," psyl info            :","@                          (1)now set detail","@                          (2)author detail","@                          (3)version message","@"," dotnet new           : support dotnet create project","@                          (1)webapi","@                          (2)console","@                          (3)classlib","@"," dotnet reference     : include(add)/remove libary class .csproj"," python new           : support python create project","@                          (1)webapi(flask)","@                          (2)console","@"," golang new           : support golang create project","@                          (1)app","@","launch               : Docker for VS Code debug(.vscode/launch.js)","@                          (1)create launch muliteple","@                          (2)launch add project","@                          (3)project info(VSCode debug)","@"];var countRow=1;helpMes.forEach(function(val,nu){if(val.indexOf("@")==-1){console.log(colors.empty+colors.grey+countRow+"."+colors.empty+colors.blue+val);countRow++}else{console.log(colors.empty+colors.blue+val.substring(1))}});console.log("");console.log("");console.log(colors.empty+colors.yellow+"----- create Date: 2019.11.09 "+colors.empty+colors.cyan+`docker v${dockerVersion}`+colors.empty+colors.yellow+"-----");console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white)}else if(anws=="ci-cd"){var cp=require("child_process");cp.exec(`docker update --restart=always ${catchYml().web}`,function(error,stdout,stderr){console.log(colors.empty+colors.yellow+"reset web --restart=always"+colors.empty+colors.white);cp.exec(`docker restart ${catchYml().web}`,function(error,stdout,stderr){cp.exec(`docker restart ${catchYml().nginx}`,function(error,stdout,stderr){console.log(colors.empty+colors.yellow+"start web"+colors.empty+colors.white);console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white)})})});async function runCI_CD(){var gitVersion=cp.spawn("git",["pull"]);var restartWebFlag=false;gitVersion.stdout.on("data",data=>{console.log(colors.empty+colors.yellow+"log->"+colors.empty+colors.grey+data);if(data.indexOf("lready up to date")==-1){restartWebFlag=true}});gitVersion.stderr.on("data",data=>{console.log(colors.empty+colors.cyan+"runing->"+colors.empty+colors.grey+data)});gitVersion.on("close",(code,signal)=>{if(restartWebFlag){console.log(colors.empty+colors.yellow+"listen restart web"+colors.empty+colors.white);cp.exec(`docker stop ${catchYml().web}`,function(error,stdout,stderr){cp.exec(`docker restart ${catchYml().web}`,function(error,stdout,stderr){cp.exec(`docker restart ${catchYml().nginx}`,function(error,stdout,stderr){console.log(colors.empty+colors.yellow+"start web"+colors.empty+colors.white);console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white)})})})}});gitVersion.on("error",err=>{console.log(colors.empty+colors.red+"error->"+colors.empty+colors.grey+error);console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white)});function formattedDateTime(date){const y=date.getFullYear();const m=("0"+(date.getMonth()+1)).slice(-2);const d=("0"+date.getDate()).slice(-2);const h=("0"+date.getHours()).slice(-2);const mi=("0"+date.getMinutes()).slice(-2);const s=("0"+date.getSeconds()).slice(-2);const ms=date.getMilliseconds();return y+"-"+m+"-"+d+" "+h+":"+mi+":"+s+"."+ms}const date=new Date;const currentTime=formattedDateTime(date);console.log(colors.empty+colors.grey+currentTime+"...");await sleep(3e3);runCI_CD()}runCI_CD()}else if(anws=="docker"){var cp=require("child_process");var dockerRunPsyl=cp.spawn("docker",["compose","stop"],{stdio:"inherit"});dockerRunPsyl.on("close",(code,signal)=>{console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white);var dockerRunPsyl1=cp.spawn("docker",["compose","rm","-f"],{stdio:"inherit"});dockerRunPsyl1.on("close",(code,signal)=>{console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white);var dockerRunPsyl2=cp.spawn("docker",["network","create",catchYml().netWorkName],{stdio:"inherit"});dockerRunPsyl2.on("close",(code,signal)=>{var dockerRunPsyl3=cp.spawn("docker",["compose","--compatibility","up","-d"],{stdio:"inherit"});dockerRunPsyl3.on("close",(code,signal)=>{var counTdown=0;async function runInit(){await sleep(300);process.stdout.clearLine();process.stdout.cursorTo(0);var toChar="";switch(counTdown){case 0:toChar="";break;case 1:toChar=".";break;case 2:toChar=".●";break;case 3:toChar=".◎●";break}process.stdout.write(colors.empty+colors.blue+" ⠿ Init      debug model        await"+colors.empty+colors.green+toChar);if(counTdown>=0){if(counTdown<3){counTdown++}else{counTdown=0}runInit()}else{process.stdout.clearLine();process.stdout.cursorTo(0)}}runInit();cp.exec(`docker stop ${catchYml().web}`,function(error,stdout,stderr){cp.exec(`docker stop ${catchYml().debug}`,async function(error,stdout,stderr){counTdown=-1;process.stdout.clearLine();process.stdout.cursorTo(0);console.log(colors.empty+colors.blue+" ⠿ Complete  for debug model    Stopped"+colors.empty+colors.white);await toCommand(["node","psyl","-map"]);cp.exec(`docker stop ${catchYml().socket}`,function(error,stdout,stderr){cp.exec(`docker stop ${catchYml().nginx}`,function(error,stdout,stderr){process.stdout.clearLine();process.stdout.cursorTo(0);console.log(colors.empty+colors.blue+" ⠿ Complete  for web            Stopped"+colors.empty+colors.white);console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white)})})})})});dockerRunPsyl3.on("error",err=>{var fs=require("fs");if(fs.existsSync("./docker-compose.yml")){fs.unlinkSync("./docker-compose.yml")}console.log(colors.empty+colors.red+error);console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white)})});dockerRunPsyl2.on("error",err=>{var fs=require("fs");if(fs.existsSync("./docker-compose.yml")){fs.unlinkSync("./docker-compose.yml")}console.log(colors.empty+colors.red+error);console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white)})});dockerRunPsyl1.on("error",err=>{console.log(colors.empty+colors.red+error);console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white)})});dockerRunPsyl.on("error",err=>{console.log(colors.empty+colors.red+error);console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white)})}else if(anws=="run"&&arg.length==3||["web","stop","-b","-d"].indexOf(anws)>-1){if(anws=="run"){rlSyncOrderLineRun.close();rlSyncOrderLineRun=null;await new Promise((resolve,reject)=>{console.log(colors.empty+colors.cyan+"(1) debug model");console.log(colors.empty+colors.cyan+"(2) stop debug model or (key down close=[control+key.c])");console.log(colors.empty+colors.cyan+"(3) run web server(preview)");console.log(colors.empty+colors.cyan+"(4) stop web server(preview)");console.log(colors.empty+colors.cyan+"(5) composer build for project (release)");let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"search type?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: enter 1"+colors.empty+"\n"+colors.empty+colors.grey+" choose for number "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();var toInfoTypeNu=-1;try{toInfoTypeNu=Number(answer)}catch(e){}if([1,2,3,4,5].indexOf(toInfoTypeNu)>-1){anws=["-d","stop","web","stop","-b"][toInfoTypeNu-1];switch(toInfoTypeNu){case 1:arg=["node","psyl",anws];toOder=[anws];break;case 2:arg=["node","psyl",anws,"-d"];toOder=[anws,"-d"];break;case 3:arg=["node","psyl",anws];toOder=[anws];break;case 4:arg=["node","psyl",anws,"web"];toOder=[anws,"web"];break;case 5:arg=["node","psyl",anws,"run"];toOder=[anws,"run"];break}resolve()}else{reject("error set type number")}})}).catch(error=>{toOder=[];if(error!=null&&error!=undefined&&error!=""){console.log(colors.empty+colors.red+colors.yellowBG+error+colors.empty)}});base64data=Buffer.from(toOder.join(" ")).toString("base64")}if(anws=="web"||anws=="stop"&&(toOder.length>=2?toOder[1]=="web":false)){var toOrder=anws=="stop"&&(toOder.length>=2?toOder[1]=="web":false)?"stop":"start";var cp=require("child_process");cp.exec(`docker ${toOrder} ${catchYml().socket}`,function(error,stdout,stderr){cp.exec(`docker ${toOrder} ${catchYml().web}`,function(error,stdout,stderr){cp.exec(`docker ${toOrder=="start"?"restart":toOrder} ${catchYml().nginx}`,function(error,stdout,stderr){if(toOder[1]!="totscdb"){console.log(colors.grey+colors.yellow+toOrder+(stdout!=""?colors.empty+colors.green+" OK":colors.empty+colors.red+" Fail")+"->"+colors.empty+colors.grey+stdout);console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white)}})})});if(toOrder=="stop"){console.log(colors.grey+colors.yellow+"close web....")}else{console.log(colors.grey+colors.yellow+`runing web (http://127.0.0.1:${catchYml().web_port})....`+colors.empty)}if(toOder[1]!="totscdb"){console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white)}}else if(anws=="-d"||anws=="stop"&&(toOder.length>=2?toOder[1]=="-d":false)){var cp=require("child_process");var toOrder=anws=="stop"&&(toOder.length>=2?toOder[1]=="-d":false)?"stop":"start";cp.exec(`docker ${toOrder} ${catchYml().socket}`,function(error,stdout,stderr){console.log(colors.grey+colors.yellow+toOrder+(stdout!=""?colors.empty+colors.green+" OK":colors.empty+colors.red+" Fail")+"->"+colors.empty+colors.grey+stdout);if(toOrder=="start"){console.log(colors.empty+colors.cyan+`runing web (http://127.0.0.1:${catchYml().web_port})....`);console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white);var counTdown=0;async function runInit(){process.stdout.clearLine();process.stdout.cursorTo(0);var toChar="";switch(counTdown){case 0:toChar="";break;case 1:toChar=".";break;case 2:toChar=".●";break;case 3:toChar=".◎●";break}process.stdout.write(colors.empty+colors.grey+"init debug model...."+colors.empty+colors.green+toChar);await sleep(300);if(counTdown>=0){if(counTdown<3){counTdown++}else{counTdown=0}runInit()}else{process.stdout.clearLine();process.stdout.cursorTo(0)}}runInit();cp.exec(`docker restart ${catchYml().web}`,function(error,stdout,stderr){cp.exec(`docker restart ${catchYml().nginx}`,function(error,stdout,stderr){cp.exec(`docker restart ${catchYml().debug}`,function(error,stdout,stderr){counTdown=-1;process.stdout.clearLine();process.stdout.cursorTo(0);console.log("");var dockerRunPsyl=cp.spawn("docker",["exec","-it",catchYml().debug,"/bin/bash","arg.sh","LWQ="],{stdio:"inherit"});dockerRunPsyl.on("close",(code,signal)=>{cp.exec(`docker inspect -f '{{.State.Status}}' ${catchYml().debug}`,async function(error1,stdout1,stderr1){if(stdout1!=undefined&&stdout1!=null?stdout1.toString().indexOf("running")>-1:false){await toCommand("node psyl stop -d".split(" "))}});console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white)});dockerRunPsyl.on("error",err=>{cp.exec(`docker inspect -f '{{.State.Status}}' ${catchYml().debug}`,async function(error1,stdout1,stderr1){if(stdout1!=undefined&&stdout1!=null?stdout1.toString().indexOf("running")>-1:false){await toCommand("node psyl stop -d".split(" "))}});console.log(colors.empty+colors.red+error);console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white)})})})})}else{var counTdown=0;async function runInit(){process.stdout.clearLine();process.stdout.cursorTo(0);var toChar="";switch(counTdown){case 0:toChar="";break;case 1:toChar=".";break;case 2:toChar=".●";break;case 3:toChar=".◎●";break}process.stdout.write(colors.empty+colors.grey+"stop debug ...."+colors.empty+colors.green+toChar);await sleep(300);if(counTdown>=0){if(counTdown<3){counTdown++}else{counTdown=0}runInit()}else{process.stdout.clearLine();process.stdout.cursorTo(0)}}runInit();cp.exec(`docker stop ${catchYml().web}`,function(error,stdout,stderr){cp.exec(`docker stop ${catchYml().debug}`,function(error,stdout,stderr){counTdown=-1;console.log("");cp.exec(`docker stop ${catchYml().nginx}`,function(error,stdout,stderr){});console.log(colors.empty+colors.yellow+"stop debug...."+colors.empty+colors.green+"OK"+colors.empty+colors.white);console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white)})})}});if(toOrder=="stop"){console.log(colors.grey+colors.yellow+"close debug model....")}else{console.log(colors.grey+colors.yellow+"runing debug model....")}}else if(toOder.join(" ")=="-b run"){var cp=require("child_process");let base64data=Buffer.from(toOder.join(" ")).toString("base64");var counTdown=0;async function runInit(){process.stdout.clearLine();process.stdout.cursorTo(0);var toChar="";switch(counTdown){case 0:toChar="";break;case 1:toChar=".";break;case 2:toChar=".●";break;case 3:toChar=".◎●";break}process.stdout.write(colors.empty+colors.yellow+"listen debug model(stop)"+colors.empty+colors.green+toChar);await sleep(300);if(counTdown>=0){if(counTdown<3){counTdown++}else{counTdown=0}runInit()}else{process.stdout.clearLine();process.stdout.cursorTo(0)}}runInit();cp.exec(`docker stop ${catchYml().socket}`,function(error,stdout,stderr){cp.exec(`docker stop ${catchYml().debug}`,function(error,stdout,stderr){cp.exec(`docker stop ${catchYml().nginx}`,function(error,stdout,stderr){cp.exec(`docker stop ${catchYml().web}`,function(error,stdout,stderr){counTdown=-1;process.stdout.clearLine();process.stdout.cursorTo(0);var dockerRunPsyl=cp.spawn("docker",["exec","-it",catchYml().command,"/bin/bash","arg.sh",base64data],{stdio:"inherit"});dockerRunPsyl.on("close",(code,signal)=>{console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white)});dockerRunPsyl.on("error",err=>{console.log(colors.empty+colors.red+error);console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white)})})})})})}}else if(anws=="dotnetreference"){if(toOder.length>0){var cp=require("child_process");var dockerRunPsyl=cp.spawn("dotnet",toOder,{stdio:"inherit"});dockerRunPsyl.on("close",(code,signal)=>{console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white)});dockerRunPsyl.on("error",err=>{console.log(colors.empty+colors.red+error);console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white)})}}else if(anws=="vscodeTasksInfo"){try{var projectArray=vscodeLaunchProjectList();vscodeTasksInfo(projectArray[arg[3]-1].name,projectArray[arg[3]-1].type)}catch(e){}}else if(runSys){var cp=require("child_process");if(anws=="-map"){console.log(colors.empty+colors.cyanBG+colors.green+" build "+colors.empty+colors.blueBG+colors.green+" Docker-Container "+colors.empty+colors.grey+"→"+colors.empty+colors.green+catchYml().web+colors.empty+colors.grey+`(http://127.0.0.1:${catchYml().web_port})`);console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white);toOder=["-p","9788"]}let base64data=Buffer.from(toOder.join(" ")).toString("base64");if(anws=="tscdb"){var fs=require("fs");if(fs.existsSync("./src/config/InterfaceJsonHost.json")){try{let fileContents=fs.readFileSync("./src/config/InterfaceJsonHost.json","utf8");if(fileContents.indexOf("get.web.com")>-1){await toCommand(["node","psyl","web","totscdb"]);await sleep(1e3)}}catch(e){console.log(colors.empty+colors.red+e)}}}if(anws=="new"&&arg.length==3){rlSyncOrderLineRun.close();rlSyncOrderLineRun=null;await new Promise((resolve,reject)=>{console.log(colors.empty+colors.cyan+"(1)create project");console.log(colors.empty+colors.cyan+"(2)create project for view");console.log(colors.empty+colors.cyan+"(3)create project for document");console.log(colors.empty+colors.cyan+"(4)create project for typeScript Model");console.log(colors.empty+colors.cyan+"(5)create models for typeScript Model");let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"search type?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: enter 1"+colors.empty+"\n"+colors.empty+colors.grey+" choose for number "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();var toProjectTypeNu=-1;try{toProjectTypeNu=Number(answer)}catch(e){}if([1,2,3,4,5].indexOf(toProjectTypeNu)>-1){anws=["project","view","document","tsc","tscmodel"][toProjectTypeNu-1];resolve()}else{reject("error set type number")}})}).then(()=>{if(anws=="project"){return new Promise(async(resolve2,reject2)=>{let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"add project name?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: projectA"+colors.empty+"\n"+colors.empty+colors.grey+" add name "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();if(answer!=""){arg=["","psyl",anws,answer.replace(/ /g,"_")];toOder=[];arg.forEach(function(an,nu){if(nu>1){toOder.push(an)}});resolve2()}else{reject2("error set project name")}})})}else{return new Promise(async(resolve,reject)=>{if(anws=="tscmodel"){anws="tsc";resolve("models")}else{var projectArray=await psylProjectListAsync();projectArray.forEach((val,nu)=>{console.log(colors.empty+colors.cyan+"("+(nu+1)+") "+val)});if(projectArray.length>0){let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"search project?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: enter 1"+colors.empty+"\n"+colors.empty+colors.grey+" choose for number "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();var toProjectNumber=-1;try{toProjectNumber=Number(answer)}catch(e){}if(toProjectNumber>0&&projectArray.length>=toProjectNumber){var projectChoose=projectArray[toProjectNumber-1];resolve(projectChoose)}else{reject("error set project number")}})}else{arg=[];toOder=[];reject("not exist project list")}}}).then(projectChoose=>{return new Promise(async(resolve2,reject2)=>{if(anws=="view"){let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"add project for view name?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: viewPage1"+colors.empty+"\n"+colors.empty+colors.grey+" add name "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();if(answer!=""){arg=["","psyl",anws,projectChoose+"<"+answer.replace(/ /g,"_")];toOder=[];arg.forEach(function(an,nu){if(nu>1){toOder.push(an)}});resolve2()}else{reject2("error set view name")}})}else if(anws=="tsc"){let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"add '"+projectChoose+"' for typescript model name?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: model/runModel"+colors.empty+"\n"+colors.empty+colors.grey+" add name "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();if(answer!=""){arg=["","psyl",anws,projectChoose+"<"+answer.replace(/ /g,"_")];toOder=[];arg.forEach(function(an,nu){if(nu>1){toOder.push(an)}});resolve2()}else{reject2("error set typescript model name")}})}else if(anws=="document"){let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"add project for document(html,scss,css) name?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: temp/runPage.html or temp2/page.scss ...."+colors.empty+"\n"+colors.empty+colors.grey+" add name "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();if(answer!=""){arg=["","psyl",anws,projectChoose+"<"+answer.replace(/ /g,"_")];toOder=[];arg.forEach(function(an,nu){if(nu>1){toOder.push(an)}});resolve2()}else{reject2("error set document name")}})}})})}}).catch(error=>{toOder=[];if(error!=null&&error!=undefined&&error!=""){console.log(colors.empty+colors.red+colors.yellowBG+error+colors.empty)}});base64data=Buffer.from(toOder.join(" ")).toString("base64")}else if(anws=="info"&&arg.length==3){rlSyncOrderLineRun.close();rlSyncOrderLineRun=null;await new Promise((resolve,reject)=>{console.log(colors.empty+colors.cyan+"(1) now set detail");console.log(colors.empty+colors.cyan+"(2) author detail");console.log(colors.empty+colors.cyan+"(3) version message");let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"search type?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: enter 1"+colors.empty+"\n"+colors.empty+colors.grey+" choose for number "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();var toInfoTypeNu=-1;try{toInfoTypeNu=Number(answer)}catch(e){}if([1,2,3].indexOf(toInfoTypeNu)>-1){anws=["-s","-a","-v"][toInfoTypeNu-1];arg=["node","psyl",anws];toOder=[anws];resolve()}else{reject("error set type number")}})}).catch(error=>{toOder=[];if(error!=null&&error!=undefined&&error!=""){console.log(colors.empty+colors.red+colors.yellowBG+error+colors.empty)}});base64data=Buffer.from(toOder.join(" ")).toString("base64")}else if(anws=="remove"&&arg.length==3){rlSyncOrderLineRun.close();rlSyncOrderLineRun=null;await new Promise((resolve,reject)=>{console.log(colors.empty+colors.cyan+"(1)remove project");console.log(colors.empty+colors.cyan+"(2)remove view");console.log(colors.empty+colors.cyan+"(3)remove typescript model");console.log(colors.empty+colors.cyan+"(4)remove normal document html/css/sacss/ts");let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"search type?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: enter 1"+colors.empty+"\n"+colors.empty+colors.grey+" choose for number "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();var toProjectTypeNu=-1;try{toProjectTypeNu=Number(answer)}catch(e){}if([1,2,3,4].indexOf(toProjectTypeNu)>-1){anws=["-rp","-rv","-rt","-r"][toProjectTypeNu-1];resolve()}else{reject("error set type number")}})}).then(()=>{return new Promise(async(resolve,reject)=>{var projectArray=await psylProjectListAsync();projectArray.forEach((val,nu)=>{console.log(colors.empty+colors.cyan+"("+(nu+1)+") "+val)});if(anws=="-rt"){console.log(colors.empty+colors.cyan+"("+(projectArray.length+1)+") models")}if(projectArray.length>0){let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"search project?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: enter 1"+colors.empty+"\n"+colors.empty+colors.grey+" choose for number "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();var toProjectNumber=-1;try{toProjectNumber=Number(answer)}catch(e){}if(toProjectNumber>0&&projectArray.length+(anws=="-rt"?1:0)>=toProjectNumber){var projectChoose=projectArray.length+1==toProjectNumber&&anws=="-rt"?"models":projectArray[toProjectNumber-1];resolve(projectChoose)}else{reject("error set project number")}})}else{arg=[];toOder=[];reject("not exist project list")}})}).then(ProjectChoose=>{return new Promise(async(resolve,reject)=>{if(anws=="-rv"){var ProjectViewArray=psylProjectPackageViewTypeList(ProjectChoose);ProjectViewArray.forEach((val,nu)=>{console.log(colors.empty+colors.cyan+"("+(nu+1)+") "+val)});if(ProjectViewArray.length>0){await new Promise(async(resolve2,reject2)=>{let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"search Project for view?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: enter 1"+colors.empty+"\n"+colors.empty+colors.grey+" choose for number "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();var toProjectNumber=-1;try{toProjectNumber=Number(answer)}catch(e){}if(toProjectNumber>0&&ProjectViewArray.length>=toProjectNumber){ProjectChoose=ProjectChoose+"<"+ProjectViewArray[toProjectNumber-1];resolve2()}else{reject2("error set project for view number")}})}).catch(error=>{toOder=[];if(error!=null&&error!=undefined&&error!=""){console.log(colors.empty+colors.red+colors.yellowBG+error+colors.empty)}})}else{arg=[];toOder=[];reject("not exist view list")}}else if(anws=="-rt"){var ppTscArray=psylProjectPackageTypeScriptPathStringList(ProjectChoose);ppTscArray.forEach((val,nu)=>{console.log(colors.empty+colors.cyan+"("+(nu+1)+") "+val)});if(ppTscArray.length>0){await new Promise(async(resolve2,reject2)=>{let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"search Project for typescript model?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: enter 1"+colors.empty+"\n"+colors.empty+colors.grey+" choose for number "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();var toProjectNumber=-1;try{toProjectNumber=Number(answer)}catch(e){}if(toProjectNumber>0&&ppTscArray.length>=toProjectNumber){ProjectChoose=ProjectChoose+"<"+ppTscArray[toProjectNumber-1];resolve2()}else{reject2("error set project for typescript model number")}})}).catch(error=>{toOder=[];if(error!=null&&error!=undefined&&error!=""){console.log(colors.empty+colors.red+colors.yellowBG+error+colors.empty)}})}else{arg=[];toOder=[];reject("not exist model list")}}else if(anws=="-r"){await new Promise(async(resolve2,reject2)=>{let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"remove document path?"+colors.empty+"\n"+colors.empty+colors.grey+"ex: view/dd/aa.css"+colors.empty+"\n"+colors.empty+colors.grey+" add path "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){rlSync.close();if(answer!=""){ProjectChoose=ProjectChoose+"<"+answer;resolve2()}else{reject2("error set path")}})}).catch(error=>{toOder=[];if(error!=null&&error!=undefined&&error!=""){console.log(colors.empty+colors.red+colors.yellowBG+error+colors.empty)}})}arg=["","psyl",anws,ProjectChoose];toOder=[];arg.forEach(function(an,nu){if(nu>1){toOder.push(an)}});resolve()})}).catch(error=>{toOder=[];if(error!=null&&error!=undefined&&error!=""){console.log(colors.empty+colors.red+colors.yellowBG+error+colors.empty)}});base64data=Buffer.from(toOder.join(" ")).toString("base64")}var dockerRunPsyl=cp.spawn("docker",["exec","-it",catchYml().command,"/bin/bash","arg.sh",base64data],{stdio:"inherit"});dockerRunPsyl.on("close",async(code,signal)=>{switch(anws){case"-rp":case"-rv":case"-r":case"project":case"view":case"tsc":case"-rt":await toCommand(["node","psyl","-map"]);break;case"document":var runFirst_map=true;arg.forEach(function(an,nu){if(an.toLowerCase().indexOf(".html")>-1&&runFirst_map){runFirst_map=false}});if(!runFirst_map){await toCommand(["node","psyl","-map"])}break;default:console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white);break}});dockerRunPsyl.on("error",err=>{console.log(colors.empty+colors.red+error);console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white)})}else{console.log(colors.empty+colors.yellow+"init for wait....");console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white)}}else if(arg.length!=0){console.log(colors.empty+colors.yellow+"input error....");console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white)}orderLineRun()}function orderLineRun(){if(rlSyncOrderLineRun==null){rlSyncOrderLineRun=require("readline").createInterface(process.stdin,process.stdout);rlSyncOrderLineRun.prompt();rlSyncOrderLineRun.on("line",async ans=>{if(saveCmmand!=ans){saveCmmand=ans;if(ans.indexOf("psyl ")==0||ans.indexOf("npm ")==0||ans.indexOf("npx ")==0||ans.indexOf("node ")==0||ans.indexOf("dotnet ")==0||ans.indexOf("python ")==0||ans.indexOf("golang ")==0||ans=="launch"){await toCommand(`node ${ans}`.split(" "))}else{console.log(colors.empty+colors.yellow+"note:"+colors.empty+colors.red+"command-> 'psyl' [...]"+colors.empty);console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white)}}});rlSyncOrderLineRun.on("resume",()=>{console.log("Resume Event is invoked.")});rlSyncOrderLineRun.on("SIGINT",()=>{});rlSyncOrderLineRun.on("SIGTSTP",async()=>{await toCommand("node psyl stop -d".split(" "));rlSyncOrderLineRun.close()})}}async function runPsylProcess(){console.log("");console.log(colors.grey+"                 ◤◢◤◢");console.log(colors.grey+"             ◤◢◤◢◤◢◤◢◤◢◤");console.log(colors.grey+"            ◤◢◤◢◤ "+colors.empty+colors.red+"◢◢"+colors.empty+colors.green+" ◢◤◢◤"+colors.empty);console.log(colors.grey+"            ◤◢◤◢◤ "+colors.empty+colors.yellow+"◤◢"+colors.empty+colors.cyan+" ◢◤◢"+colors.empty);console.log(colors.grey+"             ◤◢◤◢ ◢ ◢◤◢◢");console.log(colors.grey+"                ◤◢◢◢◤"+colors.empty);console.log(colors.blue+"Copyright © psyltw/gitime And "+colors.empty+colors.greenBG+colors.green+" Author "+colors.empty+colors.whiteBG+colors.green+" CHUNG,CHI-WEN "+colors.empty);console.log("");console.log(colors.empty+colors.grey+"◢◤◢◤"+colors.empty+colors.black+colors.reverse+"◢◤◢◤"+colors.empty+colors.grey+"◢◤◢◤"+colors.empty+colors.black+colors.reverse+"◢◤◢◤"+colors.empty+colors.green+" nodeJs "+colors.empty+colors.grey+"/ "+colors.empty+colors.black+colors.blue+"Typescript "+colors.empty+colors.grey+"/ "+colors.black+colors.magenta+"sass_scss_css "+colors.empty+colors.grey+"/ "+colors.black+colors.yellow+"js-es5");console.log(colors.empty+colors.black+colors.reverse+"◢◤◢◤"+colors.empty+colors.grey+"◢◤◢◤"+colors.empty+colors.empty+colors.black+colors.reverse+"◢◤◢◤"+colors.empty+colors.black+" Puzzle-(CI/DC) version");console.log("");console.log(colors.empty+colors.cyan+" Wellcome use "+colors.empty+colors.yellow+"|^_^| "+colors.empty+colors.red+" PSYL"+colors.empty+colors.green+"Vue "+colors.empty+colors.blackBG+" bundle(Net Core "+colors.empty+colors.greenBG+colors.yellow+"^9^"+colors.empty+colors.blackBG+"+golang_1.24/python)"+colors.empty+colors.blueBG+colors.white+" Docker "+colors.empty);console.log("");console.log(colors.grey+colors.yellow+"----- create Date: 2019.11.09 "+colors.empty+colors.blueBG+colors.green+" Docker "+colors.empty+colors.cyanBG+colors.green+` v${dockerVersion} `+colors.empty+colors.grey+colors.yellow+"-----");console.log(colors.empty+colors.magenta+" help:  psyl -h");console.log("");console.log(colors.empty+colors.magenta+" Last Update:  2025.05.05");console.log("");console.log(" defalut Port: "+catchYml().web_port);console.log("");console.log(colors.empty+"");if(process.argv.length>2){process.argv[0]="node";process.argv[1]="psyl";console.log(colors.empty+colors.yellow+"arg->"+colors.empty+colors.magenta+process.argv.join(" "));console.log("");await toCommand(process.argv)}else{orderLineRun()}}var fsInit=require("fs");if(fsInit.existsSync("./docker-compose.yml")){var cp=require("child_process");async function debungRuningClose(){cp.exec(`docker inspect -f '{{.State.Status}}' ${catchYml().debug}`,async function(error1,stdout1,stderr1){if(stdout1!=undefined&&stdout1!=null?stdout1.toString().indexOf("running")>-1:false){await toCommand("node psyl stop -d".split(" "))}})}cp.exec(`docker inspect -f '{{.State.Status}}' ${catchYml().command}`,async function(error,stdout,stderr){if(error!=undefined&&error!=null?error.toString().indexOf("Error: No such object: ")>-1:false){await toCommand("node psyl docker".split(" "))}else if(stdout!=undefined&&stdout!=null?stdout.toString().indexOf("exited")>-1:false){cp.exec(`docker start ${catchYml().command}`,async function(error,stdout,stderr){debungRuningClose()})}else if(stdout!=undefined&&stdout!=null?stdout.toString().indexOf("running")>-1:false){debungRuningClose()}})}if(catchContainerNameStr.indexOf("image:")>0){var imageV="H4sIAAAAAAAAA+2WTXObMBCG7/4VGh/qSw34q7HpqdMcm9QzPfSQ6XhkWGMc0DKS8Ed/fQUCgQOJx67jU3zwaFf7riT2WcEWuAiRuaQ7su66HQF8G3og3A4hqYC+h3GcjQkJYxqAS1bOYDIbOo5jJ+IQbVMdQpnv+ug9A8+9Omcu85BJGjLgC0ZjpZeQcNyAJ7Uwj9lilMZ6zezXJ5YtuOfaRWRueNRbg1+L+BEuKT98ukdPaZm0o9yuRIV9UrcRyJRRCUtHQwl7CcwX3zFOkClpJWnMNLR+yF37ZwLsNyzt3W7HEVui7lE+gpzrrO4LsxE9P8g1MhN9bDaiAzSR1bARZW2Fhz64ZlCL8CGJ8FBWiYPAlHtV2QiJwjiUNTuvf5IKBdfUcrpH/hhiVOUh08Fs+GBmVFIFIJWKnvY849fyjJ3h+KEgTvNIukwdgPCUzRWTj2psbQSZ3U2n7rRIEmEQhCxwSZHS56FiVykzBvqrMIJyMUz0nohZPKb7vgj/KqS7AyfuHvkzZe7XbgZyh/y5BnjVBYtislM0nA/LNHivjsuTf7TcB843w3kHS6EolSeILsJAns+0kXaKJy4ply6h0Y4eRFnoDJWFesuZHRd7+28QhlcCYfBanoEBYY1C6tMHIC1zbEsBcs3qT9qLP7qo9qfLflHB3yyr+awoHW/eevkt8S1Jrn1D3BCMG7V9gz9D3jlQZGVnarv7IzS0Z2ANh6eqn0de3OrmMn3K82g0PpNeP+ipf5+qZ8sIrlZfe3/ej4CxM/tyXQJauM7P9wukHqhSsZVrg/S0Xfc2XpxGmm1M9WRdV7pqogS5rC1dvJFakCnXvOp1NWqHdnLOdVWPas6X2uyLgzMaVUV6CWepWPiwomkk/wF9npmGXA0AAA==";const zlib=require("zlib");var buf=Buffer.from(imageV,"base64");zlib.unzip(buf,function(err,buffer){if(err)throw err;imageV=buffer.toString("utf8");var fs=require("fs");if(fs.existsSync("./docker-compose.yml")){var cp=require("child_process");cp.exec(`docker restart ${catchYml().command}`,function(error,stdout,stderr){cp.exec(`docker start ${catchYml().command}`,function(error,stdout,stderr){runSys=true})});runPsylProcess()}else{let rlSync=require("readline").createInterface({input:process.stdin,output:process.stdout});console.log(colors.empty+colors.red+"");console.log(colors.empty+colors.cyan+" Wellcome use "+colors.empty+colors.yellow+"|^_^| "+colors.empty+colors.red+" PSYL"+colors.empty+colors.green+"Vue "+colors.empty+colors.blackBG+" bundle(Net Core "+colors.empty+colors.greenBG+colors.yellow+"^9^"+colors.empty+colors.blackBG+") "+colors.empty+colors.blueBG+colors.white+" Docker "+colors.empty);console.log("");console.log("");rlSync.question(colors.empty+colors.red+" ◎ "+colors.empty+colors.yellow+"need reset to web for port?"+colors.empty+"\n"+colors.empty+colors.grey+"(default:9788)"+colors.empty+"\n"+colors.empty+colors.grey+" Anwser "+colors.empty+colors.redBG+"?"+colors.empty+colors.magentaBG+">>"+colors.empty+colors.redBG+">"+colors.empty+" ",function(answer){var toWebPort=9788;try{toWebPort=Number(answer);console.log(answer);if(answer!=""?toWebPort==0||answer*0!=0:true){toWebPort=9788;console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white);console.log(colors.empty+colors.yellow+"default port for 9788")}}catch(e){toWebPort=9788;console.log(colors.empty+colors.grey+"↘"+colors.empty+colors.white);console.log(colors.empty+colors.red+"error set port for 9788"+colors.empty)}const dateTime=Date.now();const timestamp=Math.floor(dateTime/1e3);fs.writeFile("./docker-compose.yml",imageV.replace(/eprojecte/g,timestamp).replace(/dockerpsylversion/g,dockerVersion).replace(/9788:80/g,toWebPort+":80"),function(error){runSys=true});rlSync.close();setTimeout(async function(){runPsylProcess();await toCommand("node psyl docker".split(" "))},300)})}})}else{runSys=true;runPsylProcess()}